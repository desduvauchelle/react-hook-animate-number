{"version":3,"file":"index.js","sources":["../src/easingFunctions.ts","../src/useAnimateNumber.tsx"],"sourcesContent":["// https://easings.net/#\n\n// x is a value for progress of the animation between 0 and 1\n\nexport type EasingFunction = (x: number) => number\nexport type EasingFunctionNames = \"easeInOutCubic\" | \"easeOutCirc\" | \"easeOutQuint\" | \"easeOutExpo\"\n\nconst easing: {\n\t[easingName: string]: EasingFunction\n} = {\n\teaseInOutCubic: (x: number): number => {\n\t\tif (x >= 1) return 1\n\t\treturn x < 0.5 ? 4 * x * x * x : 1 - Math.pow(-2 * x + 2, 3) / 2\n\t},\n\teaseOutCirc: (x: number): number => {\n\t\tif (x >= 1) return 1\n\t\treturn Math.sqrt(1 - Math.pow(x - 1, 2))\n\t},\n\teaseOutQuint: (x: number): number => {\n\t\tif (x >= 1) return 1\n\t\treturn 1 - Math.pow(1 - x, 5)\n\t},\n\teaseOutExpo: (x: number): number => {\n\t\treturn x === 1 ? 1 : 1 - Math.pow(2, -10 * x)\n\t}\n}\n\nexport default easing","import { useState, useEffect } from 'react'\nimport easing, { EasingFunctionNames } from './easingFunctions'\nconst FPS = 60\n\n\nexport type UseAnimateNumberProps = {\n\tnumber: number,\n\tdurationInMs?: number,\n\tdecimalPlaces?: number,\n\teasingFunctionName?: EasingFunctionNames\n}\n\nexport type UseAnimateType = (props: UseAnimateNumberProps) => { number: number, isAnimating: boolean, isGoingUp: boolean }\n\nconst useAnimateNumber: UseAnimateType =\n\t({\n\t\tnumber = 0,\n\t\tdurationInMs = 4000,\n\t\tdecimalPlaces = 0,\n\t\teasingFunctionName = \"easeOutExpo\"\n\t}) => {\n\t\tconst [currentNumber, setCurrentNumber] = useState(0)\n\t\tconst [originalNumber, setOriginalNumber] = useState(0)\n\t\tconst [currentTarget, setCurrentTarget] = useState(0)\n\t\tconst [step, setStep] = useState(0)\n\n\n\t\tuseEffect(() => {\n\t\t\tif (number === originalNumber) return\n\t\t\tlet mounted = true\n\n\t\t\t// Check if it's already in the middle of an animation\n\t\t\tif (step > 0 && currentTarget !== number) {\n\t\t\t\tsetOriginalNumber(currentNumber)\n\t\t\t\tsetStep(0)\n\t\t\t}\n\n\t\t\tlet isGoingUp = number > originalNumber\n\n\t\t\tconst numberOfSteps = Math.round(1000 / FPS * durationInMs / 1000)\n\n\t\t\tconst progress = (step + 1) / numberOfSteps\n\t\t\tlet easingFunction = easing.easeOutExpo\n\t\t\tif (easingFunctionName && easing[easingFunctionName]) {\n\t\t\t\teasingFunction = easing[easingFunctionName]\n\t\t\t}\n\t\t\tconst percentageOfTargetValue = easingFunction(progress)\n\t\t\tlet currentValue = percentageOfTargetValue * number\n\t\t\tif (!isGoingUp) {\n\t\t\t\tcurrentValue = (1 - percentageOfTargetValue) * originalNumber + number\n\t\t\t}\n\t\t\tif(currentValue !== 0){\n\t\t\t\tcurrentValue = parseFloat(currentValue.toFixed(decimalPlaces))\n\t\t\t}\n\t\t\tif (isGoingUp && currentValue > number) {\n\t\t\t\tcurrentValue = number\n\t\t\t}\n\t\t\tif (!isGoingUp && currentValue < number) {\n\t\t\t\tcurrentValue = number\n\t\t\t}\n\t\t\t// console.log(`From ${originalNumber} to ${currentTarget}. Currently: ${currentValue} ${isGoingUp? `UP⬆️`: `DOWN⬇️`}`)\n\n\t\t\tif (step === numberOfSteps || currentValue === number) {\n\t\t\t\tsetOriginalNumber(number)\n\t\t\t\tsetCurrentNumber(number)\n\t\t\t\tsetStep(0)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tif(mounted){\n\t\t\t\t\tsetCurrentTarget(number)\n\t\t\t\t\tsetStep(step + 1)\n\t\t\t\t\tsetCurrentNumber(currentValue)\n\t\t\t\t}\n\t\t\t}, 1000 / FPS)\n\n\t\t\treturn () => {\n\t\t\t\tmounted = false\n\t\t\t}\n\t\t}, [number, originalNumber, currentNumber, step])\n\n\t\treturn {\n\t\t\tnumber: currentNumber,\n\t\t\tisGoingUp: number > originalNumber,\n\t\t\tisAnimating: number !== originalNumber\n\t\t}\n\t}\n\nexport default useAnimateNumber"],"names":["easing","easeInOutCubic","x","Math","pow","easeOutCirc","sqrt","easeOutQuint","easeOutExpo","FPS","useAnimateNumber","number","durationInMs","decimalPlaces","easingFunctionName","useState","currentNumber","setCurrentNumber","originalNumber","setOriginalNumber","currentTarget","setCurrentTarget","step","setStep","useEffect","mounted","isGoingUp","numberOfSteps","round","progress","easingFunction","percentageOfTargetValue","currentValue","parseFloat","toFixed","setTimeout","isAnimating"],"mappings":"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"}